<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JUALAN CEMILAN MAK E - Spesialis Pedas Nonjok</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ------------------------------------------------------------------ */
      /* --- 2. CSS STYLES LENGKAP (VERSI OPTIMASI MOBILE FINAL) --- */
      /* ------------------------------------------------------------------ */

      /* --- Global Styles & Layout Fix --- */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html, body {
        height: 100%; 
      }

      body {
        font-family: "Poppins", sans-serif;
        background-color: #f8f8f8;
        color: #333;
        display: flex;
        flex-direction: column;
        padding-bottom: 90px; 
      }

      a {
        text-decoration: none;
        color: inherit;
      }

      .container {
        width: 90%;
        max-width: 1300px;
        margin: 0 auto;
        padding: 20px 0;
        flex-grow: 1;
        background-color: #f8f8f8;
      }

      /* --- Header Section --- */
      .main-header {
        background-color: #c90000;
        color: white;
        padding: 40px 20px; /* Padding Ringkas */
        text-align: center;
      }

      .main-header h1 {
        font-size: 2.5rem; /* Ukuran Header Ringkas */
        font-weight: 900;
        margin: 10px 0;
        letter-spacing: 1px;
      }

      .main-header p {
        font-size: 1rem;
      }

      .btn-pesan-sekarang {
        display: inline-block;
        background-color: #ff9900;
        color: white;
        padding: 15px 35px;
        border-radius: 10px;
        margin-top: 25px;
        font-weight: 700;
        font-size: 1.2rem;
        transition: background-color 0.2s;
      }
      .btn-pesan-sekarang:hover {
        background-color: #e68a00;
      }

      .info-buka {
        margin-top: 15px;
        font-weight: 600;
        font-size: 1.1rem;
        color: white; 
      }

      .location-info {
        display: block;
        margin-top: 10px;
        color: #ff9900;
        font-weight: 700;
        transition: color 0.2s;
      }
      .location-info:hover {
        color: white;
      }

      /* --- ABOUT SECTION --- */
      .about-section {
        background-color: white;
        border-radius: 15px;
        padding: 30px;
        margin: 40px 0 50px 0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        text-align: center;
      }

      /* --- Menu Grid --- */
      .menu-grid {
        /* Default: 350px minimum, 1 kolom di desktop */
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        display: grid;
        gap: 30px;
      }
      
      .menu-card {
        /* Mengurangi padding di menu card agar lebih ringkas */
        padding: 20px; 
      }
      
      .menu-info h3 {
        /* Mengurangi ukuran judul menu */
        font-size: 1.4rem; 
      }
      
      .description {
        /* Mengurangi ukuran deskripsi */
        font-size: 0.9rem;
      }

      .price {
        /* Mengurangi ukuran harga di menu */
        font-size: 2rem; 
      }
      
      .btn-tambah {
        /* Mengurangi padding tombol tambah */
        padding: 10px 20px; 
        font-size: 1rem;
      }

      /* ================================================= */
      /* --- MEDIA QUERY: TAMPILAN HP (max-width: 768px) --- */
      /* ================================================= */

      @media (max-width: 768px) {
        
        /* 1. HEADER MERAH (TIDAK KEPOTONG) */
        .main-header {
            padding: 30px 15px; /* Padding lebih kecil di HP */
        }
        .main-header h1 {
          font-size: 2rem; /* Diperkecil lagi agar tidak kepotong di HP */
        }
        .main-header p {
          font-size: 0.9rem;
        }
        .btn-pesan-sekarang {
            padding: 12px 25px;
            font-size: 1rem;
        }
        .info-buka {
            font-size: 1rem;
        }

        /* 2. MENU GRID (2 KOLOM DI HP) */
        .menu-grid {
          /* FIX: Mengubah ke 2 kolom (atau 1 kolom yang sangat kecil) */
          /* Menggunakan 2 kolom di layar HP agar tidak terlalu besar */
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: 15px;
        }

        .category-title {
            font-size: 2rem;
            margin: 40px 0 20px 0;
        }
        
        /* Menu Card di Mobile */
        .menu-card {
            padding: 15px;
            min-height: 180px; 
        }
        .menu-info h3 {
            font-size: 1.1rem; /* Judul Menu sangat kecil */
        }
        .description {
            font-size: 0.8rem;
            margin-bottom: 10px;
        }
        .price {
            font-size: 1.5rem; /* Harga kecil */
        }
        .btn-tambah {
            padding: 8px 10px;
            font-size: 0.8rem;
        }
        
        /* 3. TAMPILAN CHECKOUT (FLOATING CART) */
        .floating-cart {
          padding: 15px 15px;
        }
        .cart-summary {
          font-size: 1.1rem; /* Ringkas */
        }
        .cart-summary i {
            font-size: 1.5rem;
        }
        .btn-checkout {
            padding: 10px 15px;
            font-size: 1rem;
        }
        
        /* 4. FOOTER (TATA ULANG VERTICAL) */
        .footer-info-wrapper {
            flex-direction: column;
            gap: 10px;
            padding-bottom: 15px;
        }
        .footer-item {
            justify-content: center; 
            text-align: center;
            width: 100%;
            font-size: 0.9rem; /* Font footer kecil */
        }
        .info-tambahan {
            margin-left: 0;
            display: block; 
            font-size: 0.8rem;
        }
        .instagram-row {
            padding-top: 10px;
            padding-bottom: 15px;
            font-size: 0.9rem;
        }
        
        /* MODAL KERANJANG DI HP */
        .keranjang-modal {
            padding: 20px;
        }
        .modal-header h3 {
            font-size: 1.5rem;
        }
        .item-info p {
            font-size: 1rem;
        }
        .btn-pesan-wa {
            font-size: 1rem;
            padding: 10px 20px;
        }
        #cart-total-modal {
            font-size: 1.5rem;
        }
      } /* END MEDIA QUERY */

      /* --- Sisanya (Modal dan JS tetap sama) --- */
      /* --- Search Bar & Tabs --- */
      .search-bar {
        display: flex;
        align-items: center;
        border: 2px solid #ddd;
        padding: 15px 25px;
        border-radius: 12px;
        margin: 40px 0;
        background-color: white;
      }

      .search-bar i {
        margin-right: 15px;
        color: #777;
        font-size: 1.2rem;
      }

      .search-bar input {
        border: none;
        outline: none;
        width: 100%;
        font-size: 1.2rem;
      }

      .menu-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 40px;
      }

      .tab-button {
        background-color: #eee;
        color: #333;
        border: none;
        padding: 12px 22px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1.1rem;
        transition: background-color 0.2s, color 0.2s;
        min-width: 150px;
      }

      .tab-button.active {
        background-color: #ff9900;
        color: white;
        box-shadow: 0 4px 8px rgba(255, 153, 0, 0.4);
      }
      
      /* --- Footer Section --- */
      .main-footer {
        background-color: #444;
        color: white;
        padding: 30px 0 0 0; 
        margin-top: 50px;
        text-align: center;
        box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.2);
        width: 100%;
        margin-bottom: 0; 
      }
      
      .footer-info-wrapper {
          display: flex;
          justify-content: center; 
          align-items: center;
          flex-wrap: wrap; 
          gap: 15px 30px; 
          padding: 0 20px 20px 20px; 
          border-bottom: 1px solid #555; 
      }
      
      .footer-info-wrapper a {
          color: white;
          text-decoration: none;
      }
      .footer-info-wrapper a:hover {
          color: #ff9900;
      }


      .footer-item {
          font-size: 1rem;
          font-weight: 600;
          display: flex;
          align-items: center;
          text-align: left; 
      }

      .footer-item i {
          margin-right: 8px;
          font-size: 1.1rem;
          color: #ff9900; 
      }
      
      .info-tambahan {
          font-weight: 400; 
          color: #aaa;
          margin-left: 10px; 
      }

      .instagram-row {
          padding: 10px 20px 20px 20px;
          display: flex;
          justify-content: center;
          align-items: center;
          font-size: 1rem;
          font-weight: 600;
      }
      .instagram-row i {
          margin-right: 8px;
          color: #ff9900;
          font-size: 1.1rem;
      }

      .instagram-row a {
          color: white;
          text-decoration: none;
      }
      .instagram-row a:hover {
          color: #ff9900;
      }


      .copyright {
        font-size: 0.9rem;
        color: #aaa;
        padding: 15px 20px 25px 20px; 
      }
      
      
      /* --- Modal Styling --- */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 2000;
        justify-content: center;
        align-items: center;
      }

      .modal-overlay.active {
        display: flex;
      }

      .keranjang-modal {
        background-color: white;
        border-radius: 10px;
        padding: 40px;
        max-width: 550px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        position: relative;
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        position: sticky;
        top: 0;
        background-color: white;
        z-index: 2010;
      }

      .modal-header h3 {
        font-size: 2rem;
        color: #c90000;
      }

      .close-btn {
        background: none;
        border: none;
        font-size: 2.5rem;
        cursor: pointer;
        color: #aaa;
        line-height: 1;
      }

      #keranjang-list {
        max-height: 300px;
        overflow-y: auto;
        margin-bottom: 20px;
      }

      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px dashed #ddd;
      }

      .item-info {
        flex-grow: 1;
        margin-right: 15px;
      }

      .item-info p {
        font-weight: 700;
        font-size: 1.2rem;
      }

      .item-price {
        color: #666;
        font-size: 0.9rem;
      }

      .item-controls {
        display: flex;
        align-items: center;
      }

      .qty-button {
        background-color: #ff9900;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 700;
        font-size: 1rem;
        margin: 0 5px;
        transition: background-color 0.2s;
      }

      .qty-button.remove {
        background-color: #c90000;
      }

      .item-controls span {
        font-weight: 700;
        font-size: 1.1rem;
        min-width: 20px;
        text-align: center;
      }

      .delete-button {
        background: none;
        border: none;
        color: #c90000;
        font-size: 1.3rem;
        cursor: pointer;
        margin-right: 15px;
      }

      .modal-footer {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #eee;
        text-align: right;
        position: sticky;
        bottom: 0;
        background-color: white;
        z-index: 2010;
      }

      .total-info {
        margin-bottom: 20px;
      }

      .total-info span:first-child {
        font-weight: 700;
        font-size: 1.4rem;
        color: #333;
        margin-right: 15px;
      }

      #cart-total-modal {
        font-weight: 900;
        font-size: 1.8rem;
        color: #c90000;
      }

      .btn-pesan-wa {
        background-color: #25d366;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        font-size: 1.2rem;
        transition: background-color 0.2s;
      }

      .btn-pesan-wa i {
        margin-right: 8px;
      }

      #empty-cart-message {
        text-align: center;
        color: #777;
        font-style: italic;
        padding: 20px;
      }

      /* --- NOTIFIKASI --- */
      #notification {
        visibility: hidden;
        min-width: 250px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 16px;
        position: fixed;
        z-index: 3000;
        left: 50%;
        bottom: 60px;
        transform: translateX(-50%);
        font-size: 17px;
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
      }

      #notification.show {
        visibility: visible;
        opacity: 1;
        bottom: 90px;
      }
    </style>
  </head>
  <body>
    <header class="main-header">
      <div class="header-content">
        <p class="tagline">MAKS E'S SNACK</p>
        <h1>JUALAN CEMILAN MAK E</h1>
        <p class="sub-tagline">
          SPESIALIS PEDAS NONJOK | Nasi Cili & Cemilan Kekinian Jember
        </p>
        <a
          href="#"
          target="_blank"
          class="btn-pesan-sekarang"
          id="btn-pesan-header"
          >PESAN SEKARANG VIA WA</a
        >
        <p class="info-buka">
          <i class="fas fa-clock"></i> <span id="info-buka-text"></span>
        </p>
        <a
          href="https://maps.app.goo.gl/h3VHfwDjSok6SsZd7"
          target="_blank"
          class="location-info"
        >
          <i class="fas fa-map-marker-alt"></i> Lihat Lokasi Toko
        </a>
      </div>
    </header>

    <div class="container">
      <div class="about-section">
        <h2>ðŸ”¥ Tentang Jualan Cemilan Mak E ðŸ”¥</h2>
        <p>
          Kami adalah **Spesialis Cemilan Pedas Nonjok** dan **Nasi Cili
          Kekinian Jember**.
          <br />
          Jualan Cemilan Mak E adalah destinasi utama Anda untuk mencari cemilan
          dan makanan instan dengan sensasi pedas yang 'nonjok' di Jember. Kami
          adalah pusat cemilan kekinian dan makanan instan super pedas. Dibuat
          dengan bumbu dan racikan cabai khusus, dijamin bikin ketagihan!
        </p>
        <p>
          **Kami berkomitmen menyajikan hidangan pedas lezat dengan harga
          terjangkau.**
        </p>
      </div>

      <div class="search-bar">
        <i class="fas fa-search"></i>
        <input
          type="text"
          id="menu-search"
          placeholder="Cari menu, misal: Usus Cikruh..."
        />
      </div>

      <nav class="menu-tabs">
        <button class="tab-button active" data-category="all">
          Semua Menu
        </button>
        <button class="tab-button" data-category="instan">
          Nasi Pedas Instan
        </button>
        <button class="tab-button" data-category="kering">
          Cemilan Kering Pedas
        </button>
        <button class="tab-button" data-category="seblak">
          Seblak Instan Kering
        </button>
        <button class="tab-button" data-category="manis">
          Cemilan Manis & Lainnya
        </button>
      </nav>

      <main class="menu-section" id="menu-section"></main>
    </div>

    <footer class="main-footer">
      <div class="footer-info-wrapper">
        <div class="footer-item">
          <i class="fas fa-clock"></i>
          <span>Senin - Sabtu (08.00 - 16.00)</span>
          <span class="info-tambahan">| Minggu Tutup</span>
        </div>

        <a
          href="https://maps.app.goo.gl/h3VHfwDjSok6SsZd7"
          target="_blank"
          class="footer-item"
        >
          <i class="fas fa-map-marker-alt"></i>
          <span>Jl. Tidar Gg. Delta, Jember</span>
        </a>

        <a
          href="https://wa.me/6281234594673"
          target="_blank"
          class="footer-item"
        >
          <i class="fab fa-whatsapp"></i>
          <span>WhatsApp: 0812-3459-4673</span>
        </a>
      </div>
      
      <div class="instagram-row">
          <i class="fab fa-instagram"></i>
          <a href="https://instagram.com/camilanmake_sari" target="_blank">
            <span>Instagram: @camilanmake_sari</span>
          </a>
      </div>
      
      <p class="copyright">
        Â© 2025 Jualan Cemilan Mak E. Spesialis Pedas Nonjok Jember.
      </p>
    </footer>

    <div class="floating-cart" id="floating-cart" style="display: none;">
      <p class="cart-summary">
        <i class="fas fa-shopping-cart"></i>
        <span id="item-count">0 Item</span> |
        <span id="cart-total-footer">Rp0</span>
      </p>
      <button class="btn-checkout" id="btn-checkout" disabled>Checkout</button>
    </div>

    <div class="modal-overlay" id="keranjang-modal-overlay">
      <div class="keranjang-modal">
        <div class="modal-header">
          <h3>Keranjang Belanja</h3>
          <button class="close-btn" id="close-modal-btn">Ã—</button>
        </div>
        <div id="keranjang-list">
          </div>
        <div class="modal-footer">
          <div class="total-info">
            <span>Total:</span>
            <span id="cart-total-modal">Rp0</span>
          </div>
          <button class="btn-pesan-wa" id="btn-pesan-wa" disabled>
            <i class="fab fa-whatsapp"></i> Pesan Sekarang
          </button>
        </div>
      </div>
    </div>

    <div id="notification"></div>

    <script>
      /* ------------------------------------------------------------------ */
      /* --- 3. JAVASCRIPT LENGKAP (SEMUA LOGIKA AKTIF) --- */
      /* ------------------------------------------------------------------ */

      // Data Menu
      const menuData = [
        {
          id: "nasi_ayam",
          name: "Nasi Ayam Cili Super Hot",
          description:
            "Nasi putih + ayam goreng dengan sambal cili super pedas.",
          price: 15000,
          rating: "5.0 (60)",
          category: "instan",
        },
        {
          id: "nasi_usus",
          name: "Nasi Usus Cili Super Hot",
          description: "Nasi putih + usus pedas, bumbu cabe rawit nonjok!",
          price: 13000,
          rating: "4.8 (48)",
          category: "instan",
        },
        {
          id: "nasi_polos",
          name: "Nasi Cili Polos",
          description: "Nasi putih hangat dengan ekstra sambal cili Mak E.",
          price: 8000,
          rating: "4.9 (35)",
          category: "instan",
        },
        {
          id: "usus_cikruh",
          name: "Usus Cikruh",
          description:
            "Usus kering renyah bumbu cikruh (pedas gurih), kemasan besar.",
          price: 7000,
          rating: "4.9 (53)",
          category: "kering",
        },
        {
          id: "kaca_pedas",
          name: "Keripik Kaca Pedas",
          description: "Keripik kaca pedas gurih, renyah dan tipis.",
          price: 5000,
          rating: "4.7 (47)",
          category: "kering",
        },
        {
          id: "makaroni",
          name: "Makaroni Spiral",
          description: "Makaroni spiral kering dengan bumbu pedas ekstra.",
          price: 4000,
          rating: "4.2 (32)",
          category: "kering",
        },
        {
          id: "basreng_premium",
          name: "Basreng Premium",
          description: "Basreng kering premium pedas.",
          price: 7000,
          rating: "5.0 (6)",
          category: "kering",
        },
        {
          id: "seblak_ceker",
          name: "Seblak Ceker (Kering)",
          description: "Seblak kering instan siap seduh dengan topping ceker.",
          price: 6000,
          rating: "4.7 (41)",
          category: "seblak",
        },
        {
          id: "sus_coklat",
          name: "Sus Isi Coklat",
          description: "Kue sus mini dengan isian coklat lumer manis.",
          price: 6000,
          rating: "4.7 (41)",
          category: "manis",
        },
        {
          id: "cilok_aci",
          name: "Cilok Aci",
          description: "Cilok aci kenyal gurih.",
          price: 5000,
          rating: "4.4 (4)",
          category: "manis",
        },
      ];

      // Variabel Global
      let cart = {};
      let currentFilter = "all";
      const storeInfo = {
        open: "08:00",
        close: "16:00",
        days: [1, 2, 3, 4, 5, 6], // Senin (1) sampai Sabtu (6). Minggu (0) tutup.
        // WhatsApp number in international format
        whatsapp: "6281234594673", 
      };

      // --- HELPER FUNCTIONS ---

      function formatRupiah(number) {
        return new Intl.NumberFormat("id-ID", {
          style: "currency",
          currency: "IDR",
          minimumFractionDigits: 0,
        }).format(number);
      }

      function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.textContent = message;
        notification.classList.add("show");
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // Fungsi untuk menampilkan status jam buka 
      function updateStoreStatus() {
        const now = new Date();
        const day = now.getDay();
        const hour = now.getHours();
        const minute = now.getMinutes();
        const currentTime = hour + minute / 60;
        const openTime = 8; // 08:00
        const closeTime = 16; // 16:00

        const infoBukaElement = document.getElementById("info-buka-text");

        let statusText;
        let isStoreOpen = false;

        if (
          storeInfo.days.includes(day) &&
          currentTime >= openTime &&
          currentTime < closeTime
        ) {
          statusText = `**BUKA** (Sampai ${storeInfo.close})`;
          isStoreOpen = true;
        } else if (day === 0) {
          statusText = `TUTUP (Hari Minggu)`;
        } else if (currentTime >= closeTime) {
          statusText = `TUTUP (Buka lagi besok jam ${storeInfo.open})`;
        } else if (currentTime < openTime) {
          statusText = `TUTUP (Buka jam ${storeInfo.open})`;
        } else {
          statusText = `TUTUP`;
        }

        if (isStoreOpen) {
          infoBukaElement.style.color = '#33cc33'; // Hijau terang saat BUKA
          infoBukaElement.style.fontWeight = '800'; // Lebih tebal
        } else {
          infoBukaElement.style.color = 'white'; // Putih terang saat TUTUP
          infoBukaElement.style.fontWeight = '700';
        }

        infoBukaElement.innerHTML = statusText;
      }

      // --- MENU RENDERING & FILTERING ---

      function renderMenu(menuItems, currentFilterCategory) {
        const menuSection = document.getElementById("menu-section");
        menuSection.innerHTML = "";

        // Grouping items by category (hanya item yang ada di menuItems)
        const groupedMenu = menuItems.reduce((acc, item) => {
          const category = item.category;
          if (!acc[category]) {
            acc[category] = [];
          }
          acc[category].push(item);
          return acc;
        }, {});

        const categoryMap = {
          instan: { title: "Nasi Pedas Instan", icon: "fas fa-hotdog" },
          kering: { title: "Cemilan Kering Pedas", icon: "fas fa-pepper-hot" },
          seblak: { title: "Seblak Instan Kering", icon: "fas fa-fire-alt" },
          manis: {
            title: "Cemilan Manis & Lainnya",
            icon: "fas fa-cookie-bite",
          },
        };

        let menuCount = 0;

        // Render each category
        for (const category in categoryMap) {
          const categoryInfo = categoryMap[category];
          const itemsInCategory = groupedMenu[category] || [];

          if (itemsInCategory.length === 0) {
            continue;
          }

          menuCount += itemsInCategory.length;

          // Judul Kategori
          const titleElement = document.createElement("h2");
          titleElement.className = "category-title";
          titleElement.id = `${category}-title`;
          titleElement.innerHTML = `<i class="${categoryInfo.icon}"></i> ${categoryInfo.title}`;
          menuSection.appendChild(titleElement);

          // Grid Menu
          const gridElement = document.createElement("div");
          gridElement.className = "menu-grid";

          itemsInCategory.forEach((item) => {
            const card = document.createElement("div");
            card.className = "menu-card";
            card.innerHTML = `
                <div class="menu-info">
                  <h3>${item.name}</h3>
                  <div class="rating">
                    ${"â˜…".repeat(Math.round(parseFloat(item.rating)))} (${
                      item.rating.split(" ")[1]
                    })
                  </div>
                  <p class="description">${item.description}</p>
                </div>
                <div class="price-row">
                  <span class="price">${formatRupiah(item.price)}</span>
                  <button class="btn-tambah" data-id="${item.id}">
                    <i class="fas fa-plus"></i> Tambah
                  </button>
                </div>
              `;
            gridElement.appendChild(card);
          });

          menuSection.appendChild(gridElement);
        }

        if (menuCount === 0) {
          menuSection.innerHTML =
            '<p style="text-align: center; color: #c90000; font-size: 1.5rem; margin-top: 50px;">Maaf, menu yang Anda cari tidak ditemukan.</p>';
        }

        // Tambahkan event listener untuk tombol tambah
        menuSection.querySelectorAll(".btn-tambah").forEach((button) => {
          button.addEventListener("click", (e) =>
            addToCart(e.currentTarget.dataset.id)
          );
        });
      }

      // Fungsi yang memfilter menu berdasarkan kategori dan pencarian
      function filterMenu() {
        const searchQuery = document
          .getElementById("menu-search")
          .value.toLowerCase();

        // 1. Filter berdasarkan Kategori
        let filteredMenu = menuData.filter(
          (item) => currentFilter === "all" || item.category === currentFilter
        );

        // 2. Filter berdasarkan Pencarian (Search Query)
        if (searchQuery) {
          filteredMenu = filteredMenu.filter(
            (item) =>
              item.name.toLowerCase().includes(searchQuery) ||
              item.description.toLowerCase().includes(searchQuery)
          );
        }

        renderMenu(filteredMenu, currentFilter);
        
        // Scroll ke bagian menu setelah filter/pencarian
        if (currentFilter !== 'all' || searchQuery) {
            document.getElementById('menu-section').scrollIntoView({ behavior: 'smooth' });
        }
      }

      // --- CART LOGIC ---

      function addToCart(itemId) {
        if (cart[itemId]) {
          cart[itemId].qty++;
        } else {
          const item = menuData.find((m) => m.id === itemId);
          if (item) {
            cart[itemId] = {
              ...item,
              qty: 1,
            };
          }
        }
        updateCartUI(itemId, "tambah");
      }

      function changeQuantity(itemId, type) {
        if (!cart[itemId]) return;

        if (type === "add") {
          cart[itemId].qty++;
          updateCartUI(itemId, "tambah");
        } else if (type === "remove") {
          cart[itemId].qty--;
          if (cart[itemId].qty <= 0) {
            delete cart[itemId];
            updateCartUI(itemId, "hapus");
          } else {
            updateCartUI(itemId, "kurang");
          }
        }
      }

      function removeItem(itemId) {
        if (cart[itemId]) {
          delete cart[itemId];
          updateCartUI(itemId, "hapus");
        }
      }

      function calculateCartTotals() {
        let totalItems = 0;
        let totalPrice = 0;

        for (const id in cart) {
          totalItems += cart[id].qty;
          totalPrice += cart[id].qty * cart[id].price;
        }

        return { totalItems, totalPrice };
      }

      function updateCartUI(itemId, action) {
        const { totalItems, totalPrice } = calculateCartTotals();
        const floatingCart = document.getElementById("floating-cart");

        // 1. Logika Tampilkan/Sembunyikan Floating Cart
        if (totalItems > 0) {
          floatingCart.style.display = "flex";
        } else {
          floatingCart.style.display = "none";
        }

        // 2. Update Floating Cart Content
        document.getElementById(
          "item-count"
        ).textContent = `${totalItems} Item`;
        document.getElementById("cart-total-footer").textContent =
          formatRupiah(totalPrice);

        // 3. Update Checkout Buttons status
        const isCartEmpty = totalItems === 0;
        document.getElementById("btn-checkout").disabled = isCartEmpty;
        document.getElementById("btn-pesan-wa").disabled = isCartEmpty;

        // 4. Render Modal Keranjang
        renderCartModal();

        // 5. Show Notification
        if (action === "tambah") {
          const itemName =
            menuData.find((m) => m.id === itemId)?.name || "Produk";
          showNotification(`${itemName} berhasil ditambahkan!`);
        }
      }

      function renderCartModal() {
        const listContainer = document.getElementById("keranjang-list");
        listContainer.innerHTML = "";

        const cartArray = Object.values(cart);

        if (cartArray.length === 0) {
          listContainer.innerHTML =
            '<p id="empty-cart-message">Keranjang Anda masih kosong.</p>';
          document.getElementById("cart-total-modal").textContent =
            formatRupiah(0);
          return;
        }

        let totalModal = 0;

        // Sembunyikan pesan keranjang kosong jika ada item
        const emptyMsg = document.getElementById("empty-cart-message");
        if (emptyMsg) {
          emptyMsg.style.display = "none";
        }

        cartArray.forEach((item) => {
          totalModal += item.price * item.qty;

          const itemElement = document.createElement("div");
          itemElement.className = "cart-item";
          itemElement.innerHTML = `
                <button class="delete-button" data-id="${
                  item.id
                }"><i class="fas fa-trash-alt"></i></button>
                <div class="item-info">
                  <p>${item.name}</p>
                  <span class="item-price">@${formatRupiah(item.price)}</span>
                </div>
                <div class="item-controls">
                  <button class="qty-button remove" data-id="${
                    item.id
                  }"><i class="fas fa-minus"></i></button>
                  <span>${item.qty}</span>
                  <button class="qty-button add" data-id="${
                    item.id
                  }"><i class="fas fa-plus"></i></button>
                </div>
              `;
          listContainer.appendChild(itemElement);
        });

        document.getElementById("cart-total-modal").textContent =
          formatRupiah(totalModal);

        // Add event listeners for controls inside the modal
        listContainer.querySelectorAll(".qty-button.add").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            changeQuantity(e.currentTarget.dataset.id, "add")
          );
        });
        listContainer.querySelectorAll(".qty-button.remove").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            changeQuantity(e.currentTarget.dataset.id, "remove")
          );
        });
        listContainer.querySelectorAll(".delete-button").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            removeItem(e.currentTarget.dataset.id)
          );
        });
      }

      // Fungsi untuk membuat pesan WA
      function generateWhatsappMessage() {
        const { totalPrice } = calculateCartTotals();
        let message =
          "Halo Jualan Cemilan Mak E,\n\nSaya ingin memesan menu berikut:\n\n";

        const cartArray = Object.values(cart);
        cartArray.forEach((item, index) => {
          message += `${index + 1}. ${item.qty}x ${item.name} (${formatRupiah(
            item.price * item.qty
          )})\n`;
        });

        message += `\n*Total Belanja:* ${formatRupiah(totalPrice)}\n\n`;
        message +=
          "Mohon diproses, terima kasih.\n\n*NB: Mohon isi data diri dan info pengiriman Anda.*";

        return encodeURIComponent(message);
      }

      // Fungsi untuk membuka link WA
      function openWhatsappLink() {
        if (calculateCartTotals().totalItems === 0) {
             showNotification("Keranjang masih kosong, tidak bisa checkout.");
             return false;
        }
        const message = generateWhatsappMessage();
        const whatsappUrl = `https://wa.me/${storeInfo.whatsapp}?text=${message}`;
        window.open(whatsappUrl, "_blank");
        return true;
      }

      // --- EVENT LISTENERS & INITIALIZATION ---

      document.addEventListener("DOMContentLoaded", () => {
        // 1. Inisialisasi Status Toko
        updateStoreStatus();

        // 2. Inisialisasi Tampilan Menu
        filterMenu();

        // 3. Inisialisasi Tampilan Keranjang
        renderCartModal();

        // Event Listeners for Tabs
        document.querySelectorAll(".tab-button").forEach((button) => {
          button.addEventListener("click", (e) => {
            // Hapus kelas 'active' dari semua tombol
            document
              .querySelectorAll(".tab-button")
              .forEach((btn) => btn.classList.remove("active"));

            // Tambahkan kelas 'active' ke tombol yang diklik
            e.currentTarget.classList.add("active");

            // Set filter baru dan render ulang menu
            currentFilter = e.currentTarget.dataset.category;
            filterMenu();
          });
        });

        // Event Listener for Search Bar
        document
          .getElementById("menu-search")
          .addEventListener("input", filterMenu);

        // Event Listeners for Modal & Checkout Buttons
        document.getElementById("floating-cart").addEventListener("click", () => {
          document
            .getElementById("keranjang-modal-overlay")
            .classList.add("active");
        });

        document
          .getElementById("close-modal-btn")
          .addEventListener("click", () => {
            document
              .getElementById("keranjang-modal-overlay")
              .classList.remove("active");
          });

        document.getElementById("btn-checkout").addEventListener("click", () => {
          // Buka modal saat tombol checkout di floating cart diklik
          document
            .getElementById("keranjang-modal-overlay")
            .classList.add("active");
        });

        // Tombol "PESAN SEKARANG VIA WA" di Header
        document
          .getElementById("btn-pesan-header")
          .addEventListener("click", (e) => {
            e.preventDefault(); 
            if (calculateCartTotals().totalItems > 0) {
              openWhatsappLink();
            } else {
              showNotification("Keranjang masih kosong, silakan tambahkan menu dulu.");
              // Jika keranjang kosong, buka modal agar user bisa melihat keranjang
              document
                .getElementById("keranjang-modal-overlay")
                .classList.add("active");
            }
          });

        // Tombol "Pesan Sekarang" di Modal
        document
          .getElementById("btn-pesan-wa")
          .addEventListener("click", openWhatsappLink);
      });
    </script>
  </body>
</html>
