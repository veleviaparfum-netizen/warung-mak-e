<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JUALAN CEMILAN MAK E - Spesialis Pedas Nonjok</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ------------------------------------------------------------------ */
      /* --- 1. CSS STYLES LENGKAP (VERSI FINAL TERMASUK KOREKSI HEADER & KERANJANG) --- */
      /* ------------------------------------------------------------------ */

      /* --- Global Styles & Layout Fix --- */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
      }

      body {
        font-family: "Poppins", sans-serif;
        background-color: #f8f8f8;
        color: #333;
        display: flex;
        flex-direction: column;
        /* Tambahkan padding bawah agar floating cart tidak menutupi konten */
        padding-bottom: 90px;
      }

      a {
        text-decoration: none;
        color: inherit;
      }

      .container {
        width: 90%;
        max-width: 1300px;
        margin: 0 auto;
        padding: 20px 0;
        flex-grow: 1;
        background-color: #f8f8f8;
      }

      /* --- Header Section (Koreksi Jarak Atas) --- */
      .main-header {
        background-color: #494646;
        color: white;
        padding: 0 20px;
        position: relative;
        overflow: hidden;
        min-height: 250px;
        display: flex;
        align-items: center;
      }

      .main-header::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle,
            rgba(255, 255, 255, 0.05) 1px,
            transparent 1px
          )
          no-repeat;
        background-size: 100px 100px;
        opacity: 0.1;
        z-index: 1;
      }

      .header-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 30px;
        max-width: 1300px;
        width: 100%;
        margin: 0 auto;
        position: relative;
        z-index: 2;
        align-items: center;
        /* **JARAK ATAS DIPERBESAR (70px)** */
        padding: 70px 0;
      }

      .header-left {
        text-align: left;
      }
      .header-left .tagline {
        font-size: 1.2rem;
        font-weight: 700;
      }
      .header-left h1 {
        font-size: 3rem;
        font-weight: 900;
        margin: 0 0 10px 0;
        letter-spacing: 1px;
        line-height: 1.2;
      }
      .header-left .sub-tagline {
        font-size: 1.1rem;
        font-weight: 500;
        margin-bottom: 20px;
      }

      .btn-pesan-sekarang {
        display: inline-block;
        background-color: #faac05;
        color: white;
        padding: 15px 35px;
        border-radius: 10px;
        margin-top: 25px;
        font-weight: 700;
        font-size: 1.2rem;
        transition: background-color 0.2s;
      }
      .btn-pesan-sekarang:hover {
        background-color: #e68a00;
      }

      .header-right {
        text-align: right;
        padding: 20px;
        border-left: 1px solid rgba(255, 255, 255, 0.3);
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        margin-left: 10px;
      }

      .header-right p,
      .header-right a {
        margin-bottom: 10px;
      }

      .info-buka {
        font-weight: 600;
        font-size: 1.1rem;
        margin-top: 0;
      }

      .location-info {
        display: block;
        color: #ff9900;
        font-weight: 700;
        transition: color 0.2s;
        font-size: 1rem;
      }
      .location-info:hover {
        color: white;
      }

      /* --- ABOUT SECTION & Menu Tabs --- */

      .about-section {
        background-color: white;
        border-radius: 15px;
        padding: 30px;
        margin: 40px 0 50px 0;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        text-align: center;
      }
      .about-section h2 {
        font-size: 2.2rem;
        font-weight: 900;
        color: #413b3b;
        margin-bottom: 15px;
        border-bottom: 3px solid #ff9900;
        display: inline-block;
        padding-bottom: 5px;
      }

      .about-section p {
        font-size: 1.1rem;
        line-height: 1.6;
        margin-bottom: 20px;
        color: #555;
      }
      .search-bar {
        display: flex;
        align-items: center;
        border: 2px solid #ddd;
        padding: 15px 25px;
        border-radius: 12px;
        margin: 40px 0;
        background-color: white;
      }
      .search-bar i {
        margin-right: 15px;
        color: #777;
        font-size: 1.2rem;
      }
      .search-bar input {
        border: none;
        outline: none;
        width: 100%;
        font-size: 1.2rem;
      }
      .menu-tabs {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
        gap: 15px;
        margin-bottom: 40px;
        padding-bottom: 5px;
      }

      .tab-button {
        background-color: #eee;
        color: #333;
        border: none;
        padding: 12px 22px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1.1rem;
        transition: background-color 0.2s, color 0.2s;
        min-width: 150px;
        flex-shrink: 0;
      }
      .tab-button.active {
        background-color: #ff9900;
        color: white;
        box-shadow: 0 4px 8px rgba(255, 153, 0, 0.4);
      }

      /* --- Menu Grid & Card --- */
      .category-title {
        font-size: 2.5rem;
        font-weight: 900;
        margin: 60px 0 30px 0;
        color: #744b01;
        border-bottom: 4px solid #ff9900;
        padding-bottom: 8px;
      }
      .menu-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 30px;
      }
      .menu-card {
        background-color: white;
        border-radius: 18px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
        overflow: hidden;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height: 200px;
      }
      .menu-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
      }
      .price-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
      }
      .price {
        font-size: 2rem;
        font-weight: 900;
        color: #148f29;
      }
      .btn-tambah {
        background-color: #ff9900;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 700;
        font-size: 1rem;
        transition: background-color 0.2s, transform 0.1s;
      }

      /* --- Floating Cart --- */
      .floating-cart {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: #c90000;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 18px 25px;
        box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        border-top-left-radius: 15px;
        border-top-right-radius: 15px;
      }
      .cart-summary {
        font-size: 1.2rem;
        font-weight: 600;
      }
      .cart-summary i {
        font-size: 1.7rem;
        margin-right: 10px;
      }
      .btn-checkout {
        background-color: #ff9900;
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        font-size: 1.1rem;
        transition: background-color 0.2s;
      }

      /* --- MODAL STYLING (Koreksi Keranjang Item) --- */
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 2000;
        justify-content: center;
        align-items: center;
      }

      .modal-overlay.active {
        display: flex;
      }

      .keranjang-modal {
        background-color: white;
        border-radius: 10px;
        padding: 40px;
        max-width: 550px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        position: relative;
        max-height: 90vh;
        overflow-y: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        position: sticky;
        top: 0;
        background-color: white;
        z-index: 2010;
      }
      .modal-header h3 {
        font-size: 2rem;
        color: #c90000;
      }
      .close-btn {
        background: none;
        border: none;
        font-size: 2.5rem;
        cursor: pointer;
        color: #aaa;
        line-height: 1;
      }

      /* --- KERANJANG ITEM TERBAIK (Rapi dan Kompak) --- */
      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid #eee;
        gap: 10px;
        position: relative; /* Untuk posisi tombol hapus di mobile */
      }

      .delete-button {
        background: none;
        border: none;
        color: #c90000;
        cursor: pointer;
        font-size: 1.2rem;
        padding: 5px;
        flex-shrink: 0;
      }

      .item-info {
        flex-grow: 1;
        text-align: left;
      }
      .item-info p {
        font-weight: 700;
        font-size: 1.1rem;
        margin: 0;
      }
      .item-info .item-price {
        font-size: 0.9rem;
        color: #777;
      }

      /* --- KONTROL KUANTITAS (Bikin Rapi Menyatu) --- */
      .item-controls {
        display: flex;
        align-items: center;
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        flex-shrink: 0;
      }

      .qty-button {
        /* Hilangkan background agar hanya warna dari class add/remove yang muncul */
        background-color: transparent;
        border: none;
        padding: 8px 12px;
        cursor: pointer;
        font-weight: 700;
        font-size: 1rem;
        transition: background-color 0.2s;
        height: 40px;
        width: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .item-controls span {
        padding: 0 15px;
        font-weight: 700;
        font-size: 1.1rem;
        color: #333;
        background-color: white;
        border-left: 1px solid #ddd;
        border-right: 1px solid #ddd;
        height: 40px;
        display: flex;
        align-items: center;
      }

      /* Warna khusus untuk tombol Add/Remove */
      .qty-button.add {
        background-color: #ff9900;
        color: white;
        border: none;
      }
      .qty-button.add:hover {
        background-color: #e68a00;
      }
      .qty-button.remove {
        background-color: #c90000;
        color: white;
        border: none;
      }
      .qty-button.remove:hover {
        background-color: #a30000;
      }

      /* --- Footer Modal --- */
      .modal-footer {
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid #eee;
        text-align: right;
        position: sticky;
        bottom: 0;
        background-color: white;
        z-index: 2010;
      }
      .total-info {
        display: flex;
        justify-content: space-between;
        font-size: 1.5rem;
        font-weight: 900;
        color: #c90000;
        margin-bottom: 20px;
      }
      .btn-pesan-wa {
        background-color: #05fd3b;
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        font-size: 1.2rem;
        transition: background-color 0.2s;
        width: 100%;
        box-shadow: 0 4px 10px #00ff0d;
      }

      /* --- FOOTER KAKI --- */
      .main-footer {
        background-color: #444;
        color: white;
        padding: 30px 20px;
        text-align: center;
        width: 100%;
        margin-top: auto; /* Memastikan footer berada di bawah */
      }
      .footer-info-wrapper {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 20px 40px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 20px;
        margin-bottom: 20px;
      }
      .footer-item {
        display: flex;
        align-items: center;
        font-weight: 500;
      }
      .footer-item i {
        margin-right: 8px;
        color: #ff9900;
      }
      .footer-item span {
        margin-right: 5px;
      }
      .instagram-row {
        margin-bottom: 15px;
        font-weight: 600;
      }
      .instagram-row i {
        color: #ff9900;
        margin-right: 5px;
      }
      .instagram-row a {
        color: #ff9900;
      }
      .copyright {
        font-size: 0.8rem;
        color: #aaa;
      }

      /* --- NOTIFIKASI & MEDIA QUERY --- */
      #notification {
        visibility: hidden;
        min-width: 250px;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 16px;
        position: fixed;
        z-index: 3000;
        left: 50%;
        bottom: 60px;
        transform: translateX(-50%);
        font-size: 17px;
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
      }

      #notification.show {
        visibility: visible;
        opacity: 1;
        bottom: 90px;
      }

      /* ================================================= */
      /* --- MEDIA QUERY: TAMPILAN HP (max-width: 768px) --- */
      /* ================================================= */

      @media (max-width: 768px) {
        .main-header {
          /* **KOREKSI JARAK ATAS DI HP: 50px** */
          padding: 50px 15px;
          text-align: center;
          min-height: auto;
        }
        .header-grid {
          grid-template-columns: 1fr;
          gap: 20px;
          padding: 0;
        }
        .header-left {
          text-align: center;
        }
        .header-left h1 {
          font-size: 2rem;
        }
        .header-left .sub-tagline {
          font-size: 0.9rem;
        }
        .header-right {
          text-align: center;
          padding: 15px 0 0 0;
          border-left: none;
          border-top: 1px solid rgba(255, 255, 255, 0.3);
          align-items: center;
          margin-left: 0;
        }

        /* KERANJANG DI HP: Agar tampilan lebih fleksibel */
        .keranjang-modal {
          padding: 20px;
        }

        .cart-item {
          flex-direction: column;
          align-items: flex-start;
          padding: 10px 0;
          gap: 5px;
        }

        .delete-button {
          position: absolute;
          right: 0px;
          top: 10px;
          font-size: 1.5rem;
        }

        .item-info {
          width: 100%;
          padding-right: 50px;
        }

        .item-controls {
          align-self: flex-end;
        }

        .modal-header h3 {
          font-size: 1.5rem;
        }
        .total-info {
          font-size: 1.2rem;
        }

        .menu-grid {
          /* Ubah grid agar 1 kolom besar di mobile */
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .footer-info-wrapper {
          flex-direction: column;
          gap: 10px;
          padding-bottom: 15px;
        }
        .footer-item {
          justify-content: center;
          width: 100%;
          font-size: 0.9rem;
        }
      }
    </style>
  </head>
  <body>
    <header class="main-header">
      <div class="header-grid">
        <div class="header-left">
          <p class="tagline">MAKS E'S SNACK</p>
          <h1>JUALAN CEMILAN MAK E</h1>
          <p class="sub-tagline">
            SPESIALIS PEDAS NONJOK | Nasi Cili & Cemilan Kekinian Jember
          </p>
          <a
            href="#"
            target="_blank"
            class="btn-pesan-sekarang"
            id="btn-pesan-header"
            >PESAN SEKARANG VIA WA</a
          >
        </div>
        <div class="header-right">
          <p class="info-buka">
            <i class="fas fa-clock"></i> <span id="info-buka-text"></span>
          </p>
          <a
            href="https://maps.app.goo.gl/h3VHfwDjSok6SsZd7"
            target="_blank"
            class="location-info"
          >
            <i class="fas fa-map-marker-alt"></i> Lihat Lokasi Toko
          </a>
          <br />
          <a
            href="#"
            target="_blank"
            class="btn-pesan-sekarang"
            style="padding: 10px 20px; font-size: 1rem; margin-top: 10px"
            id="btn-pesan-header-right"
            >ORDER CEPAT</a
          >
        </div>
      </div>
    </header>

    <div class="container">
      <div class="about-section">
        <h2>ðŸ”¥ Tentang Jualan Cemilan Mak E ðŸ”¥</h2>
        <p>
          Kami adalah **Spesialis Cemilan Pedas Nonjok** dan **Nasi Cili
          Kekinian Jember**.
          <br />
          Jualan Cemilan Mak E adalah destinasi utama Anda untuk mencari cemilan
          dan makanan instan dengan sensasi pedas yang 'nonjok' di Jember. Kami
          adalah pusat cemilan kekinian dan makanan instan super pedas. Dibuat
          dengan bumbu dan racikan cabai khusus, dijamin bikin ketagihan!
        </p>
        <p>
          **Kami berkomitmen menyajikan hidangan pedas lezat dengan harga
          terjangkau.**
        </p>
      </div>

      <div class="search-bar">
        <i class="fas fa-search"></i>
        <input
          type="text"
          id="menu-search"
          placeholder="Cari menu, misal: Usus Cikruh..."
        />
      </div>

      <nav class="menu-tabs">
        <button class="tab-button active" data-category="all">
          Semua Menu
        </button>
        <button class="tab-button" data-category="instan">
          Nasi Pedas Instan
        </button>
        <button class="tab-button" data-category="kering">
          Cemilan Kering Pedas
        </button>
        <button class="tab-button" data-category="seblak">
          Seblak Instan Kering
        </button>
        <button class="tab-button" data-category="manis">
          Cemilan Manis & Lainnya
        </button>
      </nav>

      <main class="menu-section" id="menu-section"></main>
    </div>

    <footer class="main-footer">
      <div class="footer-info-wrapper">
        <div class="footer-item">
          <i class="fas fa-clock"></i>
          <span>Senin - Sabtu (08.00 - 16.00)</span>
          <span class="info-tambahan">| Minggu Tutup</span>
        </div>

        <a
          href="https://maps.app.goo.gl/h3VHfwDjSok6SsZd7"
          target="_blank"
          class="footer-item"
        >
          <i class="fas fa-map-marker-alt"></i>
          <span>Jl. Tidar Gg. Delta, Jember</span>
        </a>

        <a
          href="https://wa.me/6281234594673"
          target="_blank"
          class="footer-item"
        >
          <i class="fab fa-whatsapp"></i>
          <span>WhatsApp: 0812-3459-4673</span>
        </a>
      </div>

      <div class="instagram-row">
        <i class="fab fa-instagram"></i>
        <a href="https://instagram.com/camilanmake_sari" target="_blank">
          <span>Instagram: @camilanmake_sari</span>
        </a>
      </div>

      <p class="copyright">
        Â© 2025 Jualan Cemilan Mak E. Spesialis Pedas Nonjok Jember.
      </p>
    </footer>

    <div class="floating-cart" id="floating-cart" style="display: none">
      <p class="cart-summary">
        <i class="fas fa-shopping-cart"></i>
        <span id="item-count">0 Item</span> |
        <span id="cart-total-footer">Rp0</span>
      </p>
      <button class="btn-checkout" id="btn-checkout" disabled>Checkout</button>
    </div>

    <div class="modal-overlay" id="keranjang-modal-overlay">
      <div class="keranjang-modal">
        <div class="modal-header">
          <h3>Keranjang Belanja</h3>
          <button class="close-btn" id="close-modal-btn">Ã—</button>
        </div>
        <div id="keranjang-list"></div>
        <div class="modal-footer">
          <div class="total-info">
            <span>Total:</span>
            <span id="cart-total-modal">Rp0</span>
          </div>
          <button class="btn-pesan-wa" id="btn-pesan-wa" disabled>
            <i class="fab fa-whatsapp"></i> Pesan Sekarang
          </button>
        </div>
      </div>
    </div>

    <div id="notification"></div>

    <script>
      /* ------------------------------------------------------------------ */
      /* --- 2. JAVASCRIPT LENGKAP (SEMUA LOGIKA AKTIF) --- */
      /* ------------------------------------------------------------------ */

      // Data Menu
      const menuData = [
        {
          id: "nasi_ayam",
          name: "Nasi Ayam Cili Super Hot",
          description:
            "Nasi putih + ayam goreng dengan sambal cili super pedas.",
          price: 15000,
          rating: "5.0 (60)",
          category: "instan",
        },
        {
          id: "nasi_usus",
          name: "Nasi Usus Cili Super Hot",
          description: "Nasi putih + usus pedas, bumbu cabe rawit nonjok!",
          price: 13000,
          rating: "4.8 (48)",
          category: "instan",
        },
        {
          id: "nasi_polos",
          name: "Nasi Cili Polos",
          description: "Nasi putih hangat dengan ekstra sambal cili Mak E.",
          price: 8000,
          rating: "4.9 (35)",
          category: "instan",
        },
        {
          id: "usus_cikruh",
          name: "Usus Cikruh",
          description:
            "Usus kering renyah bumbu cikruh (pedas gurih), kemasan besar.",
          price: 7000,
          rating: "4.9 (53)",
          category: "kering",
        },
        {
          id: "kaca_pedas",
          name: "Keripik Kaca Pedas",
          description: "Keripik kaca pedas gurih, renyah dan tipis.",
          price: 5000,
          rating: "4.7 (47)",
          category: "kering",
        },
        {
          id: "makaroni",
          name: "Makaroni Spiral",
          description: "Makaroni spiral kering dengan bumbu pedas ekstra.",
          price: 4000,
          rating: "4.2 (32)",
          category: "kering",
        },
        {
          id: "basreng_premium",
          name: "Basreng Premium",
          description: "Basreng kering premium pedas.",
          price: 7000,
          rating: "5.0 (6)",
          category: "kering",
        },
        {
          id: "seblak_ceker",
          name: "Seblak Ceker (Kering)",
          description: "Seblak kering instan siap seduh dengan topping ceker.",
          price: 6000,
          rating: "4.7 (41)",
          category: "seblak",
        },
        {
          id: "sus_coklat",
          name: "Sus Isi Coklat",
          description: "Kue sus mini dengan isian coklat lumer manis.",
          price: 6000,
          rating: "4.7 (41)",
          category: "manis",
        },
        {
          id: "cilok_aci",
          name: "Cilok Aci",
          description: "Cilok aci kenyal gurih.",
          price: 5000,
          rating: "4.4 (4)",
          category: "manis",
        },
      ];

      // Variabel Global
      let cart = {};
      let currentFilter = "all";
      const storeInfo = {
        open: "08:00",
        close: "16:00",
        days: [1, 2, 3, 4, 5, 6], // Senin (1) sampai Sabtu (6). Minggu (0) tutup.
        // WhatsApp number in international format
        whatsapp: "6281234594673",
      };

      // --- HELPER FUNCTIONS ---

      function formatRupiah(number) {
        return new Intl.NumberFormat("id-ID", {
          style: "currency",
          currency: "IDR",
          minimumFractionDigits: 0,
        }).format(number);
      }

      function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.textContent = message;
        notification.classList.add("show");
        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // Fungsi untuk menampilkan status jam buka
      function updateStoreStatus() {
        const now = new Date();
        const day = now.getDay();
        const hour = now.getHours();
        const minute = now.getMinutes();
        const currentTime = hour + minute / 60;
        const openTime = 8; // 08:00
        const closeTime = 16; // 16:00

        const infoBukaElement = document.getElementById("info-buka-text");

        let statusText;
        let isStoreOpen = false;

        if (
          storeInfo.days.includes(day) &&
          currentTime >= openTime &&
          currentTime < closeTime
        ) {
          statusText = `BUKA (Sampai ${storeInfo.close})`;
          isStoreOpen = true;
        } else if (day === 0) {
          statusText = `TUTUP (Hari Minggu)`;
        } else if (currentTime >= closeTime) {
          statusText = `TUTUP (Buka lagi besok jam ${storeInfo.open})`;
        } else if (currentTime < openTime) {
          statusText = `TUTUP (Buka jam ${storeInfo.open})`;
        } else {
          statusText = `TUTUP`;
        }

        if (isStoreOpen) {
          infoBukaElement.style.color = "#FFFFFF"; // Hijau terang saat BUKA
          infoBukaElement.style.fontWeight = "800"; // Lebih tebal
        } else {
          infoBukaElement.style.color = "white"; // Putih terang saat TUTUP
          infoBukaElement.style.fontWeight = "700";
        }

        infoBukaElement.innerHTML = statusText;
      }

      // --- MENU RENDERING & FILTERING ---

      function renderMenu(menuItems, currentFilterCategory) {
        const menuSection = document.getElementById("menu-section");
        menuSection.innerHTML = "";

        const groupedMenu = menuItems.reduce((acc, item) => {
          const category = item.category;
          if (!acc[category]) {
            acc[category] = [];
          }
          acc[category].push(item);
          return acc;
        }, {});

        const categoryMap = {
          instan: { title: "Nasi Pedas Instan", icon: "fas fa-hotdog" },
          kering: { title: "Cemilan Kering Pedas", icon: "fas fa-pepper-hot" },
          seblak: { title: "Seblak Instan Kering", icon: "fas fa-fire-alt" },
          manis: {
            title: "Cemilan Manis & Lainnya",
            icon: "fas fa-cookie-bite",
          },
        };

        let menuCount = 0;

        for (const category in categoryMap) {
          const categoryInfo = categoryMap[category];
          const itemsInCategory = groupedMenu[category] || [];

          if (itemsInCategory.length === 0) {
            continue;
          }

          menuCount += itemsInCategory.length;

          const titleElement = document.createElement("h2");
          titleElement.className = "category-title";
          titleElement.id = `${category}-title`;
          titleElement.innerHTML = `<i class="${categoryInfo.icon}"></i> ${categoryInfo.title}`;
          menuSection.appendChild(titleElement);

          const gridElement = document.createElement("div");
          gridElement.className = "menu-grid";

          itemsInCategory.forEach((item) => {
            const card = document.createElement("div");
            card.className = "menu-card";
            card.innerHTML = `
                <div class="menu-info">
                  <h3>${item.name}</h3>
                  <div class="rating">
                    ${"â˜…".repeat(Math.round(parseFloat(item.rating)))} (${
              item.rating.split(" ")[1]
            })
                  </div>
                  <p class="description">${item.description}</p>
                </div>
                <div class="price-row">
                  <span class="price">${formatRupiah(item.price)}</span>
                  <button class="btn-tambah" data-id="${item.id}">
                    <i class="fas fa-plus"></i> Tambah
                  </button>
                </div>
              `;
            gridElement.appendChild(card);
          });

          menuSection.appendChild(gridElement);
        }

        if (menuCount === 0) {
          menuSection.innerHTML =
            '<p style="text-align: center; color: #c90000; font-size: 1.5rem; margin-top: 50px;">Maaf, menu yang Anda cari tidak ditemukan.</p>';
        }

        menuSection.querySelectorAll(".btn-tambah").forEach((button) => {
          button.addEventListener("click", (e) =>
            addToCart(e.currentTarget.dataset.id)
          );
        });
      }

      function filterMenu() {
        const searchQuery = document
          .getElementById("menu-search")
          .value.toLowerCase();

        let filteredMenu = menuData.filter(
          (item) => currentFilter === "all" || item.category === currentFilter
        );

        if (searchQuery) {
          filteredMenu = filteredMenu.filter(
            (item) =>
              item.name.toLowerCase().includes(searchQuery) ||
              item.description.toLowerCase().includes(searchQuery)
          );
        }

        renderMenu(filteredMenu, currentFilter);

        if (currentFilter !== "all" || searchQuery) {
          document
            .getElementById("menu-section")
            .scrollIntoView({ behavior: "smooth" });
        }
      }

      // --- CART LOGIC ---

      function addToCart(itemId) {
        if (cart[itemId]) {
          cart[itemId].qty++;
        } else {
          const item = menuData.find((m) => m.id === itemId);
          if (item) {
            cart[itemId] = {
              ...item,
              qty: 1,
            };
          }
        }
        updateCartUI(itemId, "tambah");
      }

      function changeQuantity(itemId, type) {
        if (!cart[itemId]) return;

        if (type === "add") {
          cart[itemId].qty++;
          updateCartUI(itemId, "tambah");
        } else if (type === "remove") {
          cart[itemId].qty--;
          if (cart[itemId].qty <= 0) {
            delete cart[itemId];
            updateCartUI(itemId, "hapus");
          } else {
            updateCartUI(itemId, "kurang");
          }
        }
      }

      function removeItem(itemId) {
        if (cart[itemId]) {
          delete cart[itemId];
          updateCartUI(itemId, "hapus");
        }
      }

      function calculateCartTotals() {
        let totalItems = 0;
        let totalPrice = 0;

        for (const id in cart) {
          totalItems += cart[id].qty;
          totalPrice += cart[id].qty * cart[id].price;
        }

        return { totalItems, totalPrice };
      }

      function updateCartUI(itemId, action) {
        const { totalItems, totalPrice } = calculateCartTotals();
        const floatingCart = document.getElementById("floating-cart");

        if (totalItems > 0) {
          floatingCart.style.display = "flex";
        } else {
          floatingCart.style.display = "none";
        }

        document.getElementById(
          "item-count"
        ).textContent = `${totalItems} Item`;
        document.getElementById("cart-total-footer").textContent =
          formatRupiah(totalPrice);

        const isCartEmpty = totalItems === 0;
        document.getElementById("btn-checkout").disabled = isCartEmpty;
        document.getElementById("btn-pesan-wa").disabled = isCartEmpty;

        renderCartModal();

        if (action === "tambah") {
          const itemName =
            menuData.find((m) => m.id === itemId)?.name || "Produk";
          showNotification(`${itemName} berhasil ditambahkan!`);
        }
      }

      function renderCartModal() {
        const listContainer = document.getElementById("keranjang-list");
        listContainer.innerHTML = "";

        const cartArray = Object.values(cart);

        if (cartArray.length === 0) {
          listContainer.innerHTML =
            '<p id="empty-cart-message" style="text-align:center; color:#777;">Keranjang Anda masih kosong.</p>';
          document.getElementById("cart-total-modal").textContent =
            formatRupiah(0);
          return;
        }

        let totalModal = 0;

        const emptyMsg = document.getElementById("empty-cart-message");
        if (emptyMsg) {
          emptyMsg.style.display = "none";
        }

        cartArray.forEach((item) => {
          totalModal += item.price * item.qty;

          const itemElement = document.createElement("div");
          itemElement.className = "cart-item";
          // Render item keranjang dengan kontrol kuantitas yang kompak
          itemElement.innerHTML = `
                <button class="delete-button" data-id="${
                  item.id
                }"><i class="fas fa-trash-alt"></i></button>
                <div class="item-info">
                  <p>${item.name}</p>
                  <span class="item-price">@${formatRupiah(item.price)}</span>
                </div>
                <div class="item-controls">
                  <button class="qty-button remove" data-id="${
                    item.id
                  }"><i class="fas fa-minus"></i></button>
                  <span>${item.qty}</span>
                  <button class="qty-button add" data-id="${
                    item.id
                  }"><i class="fas fa-plus"></i></button>
                </div>
              `;
          listContainer.appendChild(itemElement);
        });

        document.getElementById("cart-total-modal").textContent =
          formatRupiah(totalModal);

        // Tambahkan event listener untuk tombol di modal (karena dirender ulang)
        listContainer.querySelectorAll(".qty-button.add").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            changeQuantity(e.currentTarget.dataset.id, "add")
          );
        });
        listContainer.querySelectorAll(".qty-button.remove").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            changeQuantity(e.currentTarget.dataset.id, "remove")
          );
        });
        listContainer.querySelectorAll(".delete-button").forEach((btn) => {
          btn.addEventListener("click", (e) =>
            removeItem(e.currentTarget.dataset.id)
          );
        });
      }

      function generateWhatsappMessage() {
        const { totalPrice } = calculateCartTotals();
        let message =
          "Halo Jualan Cemilan Mak E,\n\nSaya ingin memesan menu berikut:\n\n";

        const cartArray = Object.values(cart);
        cartArray.forEach((item, index) => {
          message += `${index + 1}. ${item.qty}x ${item.name} (${formatRupiah(
            item.price * item.qty
          )})\n`;
        });

        message += `\n*Total Belanja:* ${formatRupiah(totalPrice)}\n\n`;
        message +=
          "Mohon diproses, terima kasih.\n\n*NB: Mohon isi data diri dan info pengiriman Anda.*";

        return encodeURIComponent(message);
      }

      function openWhatsappLink() {
        if (calculateCartTotals().totalItems === 0) {
          showNotification("Keranjang masih kosong, tidak bisa checkout.");
          return false;
        }
        const message = generateWhatsappMessage();
        const whatsappUrl = `https://wa.me/${storeInfo.whatsapp}?text=${message}`;
        window.open(whatsappUrl, "_blank");
        return true;
      }

      // --- EVENT LISTENERS & INITIALIZATION ---

      document.addEventListener("DOMContentLoaded", () => {
        updateStoreStatus();
        filterMenu();
        updateCartUI(); // Panggil saat awal untuk sinkronisasi

        // Event Listeners for Tabs
        document.querySelectorAll(".tab-button").forEach((button) => {
          button.addEventListener("click", (e) => {
            document
              .querySelectorAll(".tab-button")
              .forEach((btn) => btn.classList.remove("active"));
            e.currentTarget.classList.add("active");
            currentFilter = e.currentTarget.dataset.category;
            filterMenu();
          });
        });

        // Event Listener for Search Bar
        document
          .getElementById("menu-search")
          .addEventListener("input", filterMenu);

        // Event Listeners for Modal & Checkout Buttons
        document
          .getElementById("floating-cart")
          .addEventListener("click", () => {
            document
              .getElementById("keranjang-modal-overlay")
              .classList.add("active");
          });

        document
          .getElementById("close-modal-btn")
          .addEventListener("click", () => {
            document
              .getElementById("keranjang-modal-overlay")
              .classList.remove("active");
          });

        document
          .getElementById("btn-checkout")
          .addEventListener("click", () => {
            document
              .getElementById("keranjang-modal-overlay")
              .classList.add("active");
          });

        // Tombol WA di Header
        const waClick = (e) => {
          e.preventDefault();
          if (calculateCartTotals().totalItems > 0) {
            openWhatsappLink();
          } else {
            showNotification(
              "Keranjang masih kosong, silakan tambahkan menu dulu."
            );
            document
              .getElementById("keranjang-modal-overlay")
              .classList.add("active");
          }
        };

        document
          .getElementById("btn-pesan-header")
          .addEventListener("click", waClick);
        document
          .getElementById("btn-pesan-header-right")
          .addEventListener("click", waClick);

        // Tombol "Pesan Sekarang" di Modal
        document
          .getElementById("btn-pesan-wa")
          .addEventListener("click", openWhatsappLink);
      });
    </script>
  </body>
</html>
